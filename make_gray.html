<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>I am a shit!</title>
  <script type="text/javascript">

    var image;
    function upload() {
      var imgcanvas = document.getElementById("canvas");
      var fileinput = document.getElementById("finput");
      image = new SimpleImage(fileinput);
      image.drawTo(imgcanvas);
    }

    function gray() {
      // document.getElementById("my").innerHTML = "shit";
      for (var pixel of image.values()) {
        var avg = (pixel.getRed() + pixel.getGreen() + pixel.getBlue()) / 3;
        pixel.setGreen(avg);
        pixel.setRed(avg);
        pixel.setBlue(avg);
      }
      var imgcanvas = document.getElementById("canvas");
      image.drawTo(imgcanvas);
    }

  </script>




  <style type="text/css">
    canvas {
      height: 500px;
      border: 1px solid lightgray;
    }

    input {
      font-size: 14pt;
    }

    div {
      text-align: center;
    }
  </style>



</head>

<body>
  <script src="https://www.dukelearntoprogram.com/course1/common/js/image/SimpleImage.js">
  </script>

  <div>
    <h1> Hearder</h1>
    <canvas id="canvas">
    </canvas>
    <p>
      filename

      <input type="file" multiple="false" accept="image/*" id="finput" onchange="upload()">

      <input type="button" id="button1" value="makegray" onclick="gray()">
      <!-- 找了半天的bug，最大的问题就是此处的button后面的属性要带onclick而不是onchange -->
      <!-- <a id="my">AA</a>  // document.getElementById("my").innerHTML = "shit"; -->
      <!-- 这两行可以输出文本，可以拿来找bug -->

  </div>

</body>

</html>
<!-- 一开始用codepen总是不成功，后来发现codepen或许是因为网络原因就是不行。幸亏换了VC。 -->